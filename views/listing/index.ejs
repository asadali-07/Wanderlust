<% layout("/layouts/boilerplate.ejs") %>

<div class="filters d-flex flex-row gap-5 flex-wrap align-items-center">
  <% const categories = [ { name: "trending", icon: "fa-fire", label: "Trending"
  }, { name: "iconic", icon: "fa-mountain-city", label: "Iconic Cities" }, {
  name: "mountains", icon: "fa-mountain", label: "Mountains" }, { name:
  "castles", icon: "fa-fort-awesome", label: "Castles" }, { name:
  "amazingpools", icon: "fa-person-swimming", label: "Amazing Pools" }, { name:
  "artics", icon: "fa-snowflake", label: "Artics" }, { name: "island", icon:
  "fa-tree", label: "Island" } ]; %> <% categories.forEach(cat => { %>
  <div class="filter text-center mt-3">
    <a
      href="/listings/category/<%= cat.name %>"
      class="link-underline link-underline-opacity-0 text-black"
    >
      <i class="fa-solid <%= cat.icon %>"></i>
      <p><%= cat.label %></p>
    </a>
  </div>
  <% }) %>

  <div class="tax-toggle filter">
    <div class="form-check-reverse form-switch m-2">
      <input
        class="form-check-input"
        type="checkbox"
        id="flexSwitchCheckDefault"
      />
      <label class="form-check-label" for="flexSwitchCheckDefault">
        Display total after taxes
      </label>
    </div>
  </div>
</div>

<% if(allListings.length==0){ %>
<div class="alert alert-info mt-3" role="alert">
  No listings found. Please try by name ,country or location.
</div>
<a
  href="/listings"
  class="btn btn-outline-danger btn-lg"
  role="button"
  aria-pressed="true"
  >Go To Explore Page</a
>
<% } %>
<div class="row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 list">
  <% for (listing of allListings) {%>
  <a href="/listings/<%= listing._id %>" class="link">
    <div class="card listing-card">
      <img src="<%= listing.image.url %>" class="card-img-top" alt="..." />
      <div class="card-img-overlay"></div>
      <div class="card-body">
        <h5 class="card-title"><%= listing.title %></h5>
        <p class="card-text">
          &#8377; <%= listing.price.toLocaleString()%>/ night
          <i class="tax-info">&nbsp; &nbsp;<b>+18% GST</b></i>
        </p>
      </div>
    </div>
  </a>
  <% } %>
</div>
<script>
  let taxToggle = document.getElementById("flexSwitchCheckDefault");
  taxToggle.addEventListener("change", () => {
    let taxInfo = document.getElementsByClassName("tax-info");
    for (info of taxInfo) {
      if (info.style.display !== "inline") {
        info.style.display = "inline";
      } else {
        info.style.display = "none";
      }
    }
  });
</script>
